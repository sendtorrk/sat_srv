//
// Author: Raja Kannan
//

'use strict';

const models = require('../db/models');

class TeamsService {
  constructor() {

  }

  /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  // Get all teams
  /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  async getTeams() {
    return await models.Team.findAll({
      raw: true
    });
  }

  /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  // Get team by name & ownerEmail
  /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  async getTeam(name, ownerEmail) {
    return await models.Team.findOne({
      where: {
        name: name,
        ownerEmail: ownerEmail
      },
      raw: true
    });
  }

  /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  // Create new team
  /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  async createTeam(name, ownerEmail) {
    await models.Team.create({
      name: name,
      ownerEmail: ownerEmail
    });
  }

  /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  // Update team
  /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  async updateTeam(id, newName, newOwnerEmail) {
    const team = await models.Team.findByPk(id);

    team.name = newName;
    team.ownerEmail = newOwnerEmail;

    await team.save();
  }

  /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  // Remove all teams
  /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  async deleteAllTeams() {
    return await models.Team.destroy({
      where: {},
      truncate: false
    });
  }
}

module.exports = new TeamsService();
