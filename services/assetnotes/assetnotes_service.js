//
// Author: Raja Kannan
//

'use strict';

const models = require('../db/models');

class AssetNotesService {
  constructor() {

  }

  /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  // Get asset notes by asset
  /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  async getAssetNotesByAssetId(assetId) {
    return await models.AssetNote.findAll({
      where: {
        AssetId: assetId
      },
      raw: true
    });
  }

  /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  // Create asset note
  /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  async createAssetNote(assetId, note, userEmail) {
    await models.AssetNote.create({
      AssetId: assetId,
      note: note,
      userEmail: userEmail
    });
  }

  /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  // Delete all asset notes
  /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  async deleteAllAssetNotes() {
    await models.AssetNote.destroy(
      {
        where: {},
        truncate: false
      }
    );
  }
}

module.exports = new AssetNotesService();